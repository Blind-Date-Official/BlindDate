(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[21728],{32296:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/versions/v46.0.0/sdk/audio",function(){return c(8684)}])},79475:function(c,a,b){"use strict";b.d(a,{Y:function(){return d},Z:function(){return e}});var d="https://snack.expo.dev";function e(a){var c=a.templateId,d=a.code,e=a.files,f=a.baseURL,b={};return e&&Object.keys(e).forEach(function(a){var c=e[a];/\.(jsx?|tsx?|json|md)$/i.test(a)?b[a]={type:"CODE",url:c.match(/^https?:\/\//)?c:"".concat(f,"/").concat(c)}:b[a]={type:"ASSET",contents:c}}),c?b["App.js"]={type:"CODE",url:"".concat(f,"/").concat(c,".js")}:d&&(b["App.js"]={type:"CODE",contents:d}),b}},25374:function(f,d,a){"use strict";a.d(d,{F:function(){return o}});var g=a(26042),h=a(69396),i=a(35944),c=a(70917),b=a(4903);a(67294);var j=a(26084),k=a(18722),l=(0,c.iv)("line-height:1.8rem;margin-top:1.4rem;margin-bottom:1.4rem;color:",b.theme.text.default,";"),m=(0,c.iv)("font-family:",b.typography.fontFaces.medium,";font-weight:400;text-decoration:none;color:",b.theme.link.default,";:hover{text-decoration:underline;}"),n=(0,c.iv)("text-decoration:none;color:",b.theme.link.default,";:hover{text-decoration:underline;}"),e=function(a){var b,c=a.packageName,d=a.hideBareInstructions,e=a.cmd,h=void 0===e?["$ expo install ".concat(c)]:e,f=a.href,o=void 0===f?(b=c,"https://github.com/expo/expo/tree/main/packages/".concat(b.split(" ")[0])):f,g=(0,j.y)().sourceCodeUrl;return(0,i.BX)(i.HY,{children:[(0,i.tZ)(k.o,{cmd:h}),void 0!==d&&d?null:(0,i.BX)("p",{css:l,children:["If you're installing this in a"," ",(0,i.tZ)("a",{css:n,href:"/introduction/managed-vs-bare/#bare-workflow",children:"bare React Native app"}),", you should also follow"," ",(0,i.tZ)("a",{css:m,href:null!=g?g:o,children:"these additional installation instructions"}),"."]})]})};d.Z=e;var o=function(b){var a,c=(0,j.y)().packageName;return(0,i.tZ)(e,(0,h.Z)((0,g.Z)({},b),{packageName:null!==(a=b.packageName)&& void 0!==a?a:c}))}},67394:function(f,c,a){"use strict";a.d(c,{Z:function(){return b}});var g=a(51438),h=a(88029),i=a(29815),j=a(82337),k=a(35944),l=a(4903),d=a(67294),m=a(79475),e=a(72093),n=a(48192),o="v".concat(a(4147).i8),b=function(c){(0,h.Z)(a,c);var e=(0,j.Z)(a);function a(){var b;return(0,g.Z)(this,a),b=e.apply(this,arguments),b.contentRef=d.createRef(),b.state={ready:!1},b.getSelectedDocsVersion=function(){var a=b.context.version;return"latest"===a?o:a},b.getSnackSdkVersion=function(){var a=b.getSelectedDocsVersion();return"unversioned"===a&&(a=o),a.replace("v","")},b.getExamplesPath=function(){return"".concat(document.location.origin,"/static/examples/").concat(b.getSelectedDocsVersion())},b.getDependencies=function(){return(0,i.Z)(b.props.dependencies).join(",")},b.getCode=function(){return(b.contentRef.current&&b.contentRef.current.textContent||"").replace(/%%placeholder-start%%.*%%placeholder-end%%/g,"")},b}var b=a.prototype;return b.componentDidMount=function(){this.setState({ready:!0})},b.render=function(){return(0,k.BX)("div",{style:{marginBottom:l.spacing[4]},children:[(0,k.tZ)("div",{ref:this.contentRef,style:this.props.contentHidden?{display:"none"}:void 0,children:this.props.children}),(0,k.BX)("form",{action:m.Y,method:"POST",target:"_blank",children:[(0,k.tZ)("input",{type:"hidden",name:"platform",value:this.props.defaultPlatform||"android"}),(0,k.tZ)("input",{type:"hidden",name:"name",value:this.props.label||"Example"}),(0,k.tZ)("input",{type:"hidden",name:"dependencies",value:this.getDependencies()}),(0,k.tZ)("input",{type:"hidden",name:"sdkVersion",value:this.getSnackSdkVersion()}),this.props.platforms&&(0,k.tZ)("input",{type:"hidden",name:"supportedPlatforms",value:this.props.platforms.join(",")}),this.state.ready&&(0,k.tZ)("input",{type:"hidden",name:"files",value:JSON.stringify((0,m.Z)({templateId:this.props.templateId,code:this.getCode(),files:this.props.files,baseURL:this.getExamplesPath()}))}),(0,k.tZ)(n.z,{disabled:!this.state.ready,iconRight:(0,k.tZ)(l.ArrowUpRightIcon,{color:l.theme.palette.white}),type:"submit",children:this.props.buttonTitle||"Try this example on Snack"})]})]})},a}(d.Component);b.contextType=e.m$,b.defaultProps={dependencies:[]}},18722:function(e,d,c){"use strict";c.d(d,{o:function(){return A}});var f=c(35944),b=c(70917),a=c(4903),g=c(67294),h=function(a){var d=a.children,e=a.style,c=a.includeMargin;return(0,f.tZ)("div",{css:[i,(void 0===c||c)&&j,(0,b.iv)(e)],children:d})},i=(0,b.iv)({display:"flex",flexDirection:"column"}),j=(0,b.iv)({marginBottom:a.spacing[4]}),k=function(a){var d=a.children,b=a.alwaysDark,c=a.hideOverflow;return(0,f.tZ)("div",{css:[l,void 0!==b&&b&&m,void 0!==c&&c&&n],children:d})},l=(0,b.iv)("background-color:",a.theme.palette.black,";border:1px solid ",a.theme.border.default,";border-bottom-left-radius:",a.borderRadius.medium,"px;border-bottom-right-radius:",a.borderRadius.medium,"px;padding:",a.spacing[4],"px;overflow-x:auto;code{padding-left:0;padding-right:0;}"),m=(0,b.iv)("border-color:transparent;white-space:nowrap;"),n=(0,b.iv)("overflow:hidden;code{white-space:nowrap;}"),o=c(69036),p=function(b){var g=b.title,c=b.children,d=b.alwaysDark,e=void 0!==d&&d;return(0,f.BX)("div",{css:[q,e&&r],children:[(0,f.tZ)(o.GP,{css:[s,e&&{color:a.darkTheme.text.default}],children:g}),!!c&&(0,f.tZ)("div",{css:t,children:c})]})},q=(0,b.iv)("background-color:",a.theme.background.default,";border:1px solid ",a.theme.border.default,";border-bottom:none;border-top-left-radius:",a.borderRadius.medium,"px;border-top-right-radius:",a.borderRadius.medium,"px;display:flex;padding:0 8px 0 16px;justify-content:space-between;min-height:42px;"),r=(0,b.iv)("background-color:",a.darkTheme.background.tertiary,";border-color:transparent;"),s=(0,b.iv)("line-height:42px !important;user-select:none;"),t=(0,b.iv)("display:flex;justify-content:flex-end;align-items:center;"),u=c(26042),v=c(69396),w=c(99534),x=c(48192),y=function(b){var h=b.children,c=b.icon,d=b.alwaysDark,e=void 0!==d&&d,i=(0,w.Z)(b,["children","icon","alwaysDark"]),j={color:e?a.darkTheme.text.default:void 0,size:a.iconSize.small},k=c&&g.cloneElement(c,j);return(0,f.tZ)(x.z,(0,v.Z)((0,u.Z)({size:"mini",theme:"transparent",icon:k},i),{children:(0,f.tZ)(o.u5,{css:e&&{color:a.darkTheme.text.default},children:h})}))},z=function(b){var h=b.text,e=(0,w.Z)(b,["text"]),c=(0,g.useState)(!1),d=c[0],i=c[1];return(0,f.tZ)(y,(0,v.Z)((0,u.Z)({icon:(0,f.tZ)(a.ClipboardIcon,{}),onClick:function(){var a;null===(a=navigator.clipboard)|| void 0===a||a.writeText(h),i(!0),setTimeout(function(){return i(!1)},1500)},disabled:d},e),{children:d?"Copied!":"Copy"}))},A=function(a){var b=a.cmd,e=a.cmdCopy,g=a.hideOverflow,c=a.includeMargin,d=a.title;return(0,f.BX)(h,{style:D,includeMargin:void 0===c||c,children:[(0,f.tZ)(p,{alwaysDark:!0,title:void 0===d?"Terminal":d,children:B({cmd:b,cmdCopy:e})}),(0,f.tZ)(k,{alwaysDark:!0,hideOverflow:g,children:b.map(C)})]})};function B(a){var c=a.cmd,d=a.cmdCopy,b=d||function(b){var a=b.filter(function(a){return!a.startsWith("#")&&""!==a});if(1===a.length)return a[0].startsWith("$")?a[0].slice(2):a[0]}(c);return b&&(0,f.tZ)(z,{alwaysDark:!0,text:b})}function C(b,d){var c="line-".concat(d);return""===b.trim()?(0,f.tZ)("br",{css:E},c):b.startsWith("#")?(0,f.tZ)(o.cO,{css:[F,E,{color:a.darkTheme.code.comment}],children:b},c):b.startsWith("$")?(0,f.BX)("div",{children:[(0,f.tZ)(o.cO,{css:[F,E,{display:"inline",color:a.darkTheme.text.secondary},],children:"\u2192\xa0"}),(0,f.tZ)(o.cO,{css:F,children:b.substring(1).trim()})]},c):(0,f.tZ)(o.cO,{css:[F,{display:"inherit"}],children:b},c)}var D=(0,b.iv)("li &{margin-top:",a.spacing[4],"px;display:flex;}"),E=(0,b.iv)("user-select:none;"),F=(0,b.iv)("display:inline-block;line-height:130%;background-color:transparent;border:none;color:",a.darkTheme.text.default,";")},8684:function(f,b,a){"use strict";a.r(b),a.d(b,{default:function(){return e},headings:function(){return d},meta:function(){return c}});var g=a(99534);a(67294);var h=a(3905),i=a(25374),j=a(28045),k=a(67394),l=a(41765),c={title:"Audio",sourceCodeUrl:"https://github.com/expo/expo/tree/sdk-46/packages/expo-av",packageName:"expo-av"},d=[{depth:2,type:"text",title:"Installation"},{depth:2,type:"text",title:"Usage"},{depth:3,type:"text",title:"Playing sounds"},{depth:3,type:"text",title:"Recording sounds"},{depth:3,type:"text",title:"Playing or recording audio in background (iOS)"},{depth:3,type:"text",title:"Notes on web usage"},{depth:2,type:"text",title:"API"},{depth:2,type:"text",title:"Unified API"}],m={meta:c,headings:d};function e(a){var b=a.components,c=(0,g.Z)(a,["components"]);return(0,h.kt)("wrapper",Object.assign({},m,c,{components:b,mdxType:"MDXLayout"}),(0,h.kt)("p",null,(0,h.kt)("strong",{parentName:"p"},(0,h.kt)("inlineCode",{parentName:"strong"},"expo-av"))," allows you to implement audio playback and recording in your app."),(0,h.kt)("p",null,"Note that audio automatically stops if headphones / bluetooth audio devices are disconnected."),(0,h.kt)("p",null,"Try the ",(0,h.kt)("a",Object.assign({parentName:"p"},{href:"https://expo.dev/@documentation/playlist-example"}),"playlist example app")," (source code is ",(0,h.kt)("a",Object.assign({parentName:"p"},{href:"https://github.com/expo/playlist-example"}),"on GitHub"),") to see an example usage of the media playback API, and the ",(0,h.kt)("a",Object.assign({parentName:"p"},{href:"https://expo.dev/@documentation/record"}),"recording example app")," (source code is ",(0,h.kt)("a",Object.assign({parentName:"p"},{href:"https://github.com/expo/audio-recording-example"}),"on GitHub"),") to see an example usage of the recording API."),(0,h.kt)(j.Z,{android:!0,emulator:!0,ios:!0,simulator:!0,web:!0,mdxType:"PlatformsSection"}),(0,h.kt)("h2",Object.assign({},{id:"installation"}),"Installation"),(0,h.kt)(i.F,{mdxType:"APIInstallSection"}),(0,h.kt)("h2",Object.assign({},{id:"usage"}),"Usage"),(0,h.kt)("h3",Object.assign({},{id:"playing-sounds"}),"Playing sounds"),(0,h.kt)(k.Z,{label:"Playing sounds",dependencies:["expo-av","expo-asset"],files:{"assets/Hello.mp3":"https://snack-code-uploads.s3.us-west-1.amazonaws.com/~asset/c9c43b458d6daa9771a7287cae9f5b47"},mdxType:"SnackInline"},(0,h.kt)("pre",null,(0,h.kt)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),"import * as React from 'react';\nimport { Text, View, StyleSheet, Button } from 'react-native';\nimport { Audio } from 'expo-av';\n\nexport default function App() {\n  const [sound, setSound] = React.useState();\n\n  async function playSound() {\n    console.log('Loading Sound');\n    /* @info */ const { sound } = await Audio.Sound.createAsync(\n      /* @end */ require('./assets/Hello.mp3')\n    );\n    setSound(sound);\n\n    console.log('Playing Sound');\n    await /* @info */ sound.playAsync(); /* @end */\n  }\n\n  React.useEffect(() => {\n    return sound\n      ? () => {\n          console.log('Unloading Sound');\n          /* @info Always unload the Sound after using it to prevent memory leaks.*/ sound.unloadAsync(); /* @end */\n        }\n      : undefined;\n  }, [sound]);\n\n  return (\n    <View style={styles.container}>\n      <Button title=\"Play Sound\" onPress={playSound} />\n    </View>\n  );\n}\n\n/* @hide const styles = StyleSheet.create({ ... }); */\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    backgroundColor: '#ecf0f1',\n    padding: 10,\n  },\n});\n/* @end */\n"))),(0,h.kt)("h3",Object.assign({},{id:"recording-sounds"}),"Recording sounds"),(0,h.kt)(k.Z,{label:"Recording sounds",dependencies:["expo-av","expo-asset"],mdxType:"SnackInline"},(0,h.kt)("pre",null,(0,h.kt)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),"import * as React from 'react';\nimport { Text, View, StyleSheet, Button } from 'react-native';\nimport { Audio } from 'expo-av';\n\nexport default function App() {\n  const [recording, setRecording] = React.useState();\n\n  async function startRecording() {\n    try {\n      console.log('Requesting permissions..');\n      /* @info */ await Audio.requestPermissionsAsync();\n      await Audio.setAudioModeAsync({\n        allowsRecordingIOS: true,\n        playsInSilentModeIOS: true,\n      }); /* @end */\n\n      console.log('Starting recording..');\n      /* @info */ const { recording } = await Audio.Recording.createAsync(\n        /* @end */ Audio.RecordingOptionsPresets.HIGH_QUALITY\n      );\n      setRecording(recording);\n      console.log('Recording started');\n    } catch (err) {\n      console.error('Failed to start recording', err);\n    }\n  }\n\n  async function stopRecording() {\n    console.log('Stopping recording..');\n    setRecording(undefined);\n    /* @info */ await recording.stopAndUnloadAsync();\n    const uri = recording.getURI(); /* @end */\n\n    console.log('Recording stopped and stored at', uri);\n  }\n\n  return (\n    <View style={styles.container}>\n      <Button\n        title={recording ? 'Stop Recording' : 'Start Recording'}\n        onPress={recording ? stopRecording : startRecording}\n      />\n    </View>\n  );\n}\n\n/* @hide const styles = StyleSheet.create({ ... }); */\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    backgroundColor: '#ecf0f1',\n    padding: 10,\n  },\n});\n/* @end */\n"))),(0,h.kt)("h3",Object.assign({},{id:"playing-or-recording-audio-in-background-ios"}),"Playing or recording audio in background (iOS)"),(0,h.kt)("p",null,"On iOS, audio playback and recording in background is only available in standalone apps, and it requires some extra configuration.\nOn iOS, each background feature requires a special key in ",(0,h.kt)("inlineCode",{parentName:"p"},"UIBackgroundModes")," array in your ",(0,h.kt)("strong",{parentName:"p"},"Info.plist")," file.\nIn standalone apps this array is empty by default, so in order to use background features you will need to add appropriate keys to your ",(0,h.kt)("strong",{parentName:"p"},"app.json")," configuration."),(0,h.kt)("p",null,"See an example of ",(0,h.kt)("strong",{parentName:"p"},"app.json")," that enables audio playback in background:"),(0,h.kt)("pre",null,(0,h.kt)("code",Object.assign({parentName:"pre"},{className:"language-json"}),'{\n  "expo": {\n    ...\n    "ios": {\n      ...\n      "infoPlist": {\n        ...\n        "UIBackgroundModes": [\n          "audio"\n        ]\n      }\n    }\n  }\n}\n')),(0,h.kt)("h3",Object.assign({},{id:"notes-on-web-usage"}),"Notes on web usage"),(0,h.kt)("ul",null,(0,h.kt)("li",{parentName:"ul"},"A MediaRecorder issue on Chrome produces WebM files missing the duration metadata. ",(0,h.kt)("a",Object.assign({parentName:"li"},{href:"https://bugs.chromium.org/p/chromium/issues/detail?id=642012"}),"See the open Chromium issue")),(0,h.kt)("li",{parentName:"ul"},"MediaRecorder encoding options and other configurations are inconsistent across browsers, utilising a Polyfill such as ",(0,h.kt)("a",Object.assign({parentName:"li"},{href:"https://github.com/kbumsik/opus-media-recorder"}),"kbumsik/opus-media-recorder"),"\nor ",(0,h.kt)("a",Object.assign({parentName:"li"},{href:"https://github.com/ai/audio-recorder-polyfill"}),"ai/audio-recorder-polyfill")," in your application will improve your experience.\nAny options passed to ",(0,h.kt)("inlineCode",{parentName:"li"},"prepareToRecordAsync")," will be passed directly to the MediaRecorder API and as such the polyfill."),(0,h.kt)("li",{parentName:"ul"},"Web browsers require sites to be served securely in order for them to listen to a mic.\nSee ",(0,h.kt)("a",Object.assign({parentName:"li"},{href:"https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia#security"}),"MediaDevices#getUserMedia Security")," for more details.")),(0,h.kt)("h2",Object.assign({},{id:"api"}),"API"),(0,h.kt)("pre",null,(0,h.kt)("code",Object.assign({parentName:"pre"},{className:"language-js"}),"import { Audio } from 'expo-av';\n")),(0,h.kt)(l.Z,{packageName:"expo-audio",apiName:"Audio",mdxType:"APISection"}),(0,h.kt)("h2",Object.assign({},{id:"unified-api"}),"Unified API"),(0,h.kt)("p",null,"The rest of the API on the ",(0,h.kt)("inlineCode",{parentName:"p"},"Sound.Audio")," is the same as the API for ",(0,h.kt)("inlineCode",{parentName:"p"},"Video")," component ",(0,h.kt)("inlineCode",{parentName:"p"},"ref")," - see the ",(0,h.kt)("a",Object.assign({parentName:"p"},{href:"/versions/v46.0.0/sdk/av/#playback"}),"AV documentation")," for further information."))}e.isMDXComponent=!0}},function(a){a.O(0,[43611,49774,92888,40179],function(){var b;return a(a.s=32296)}),_N_E=a.O()}])